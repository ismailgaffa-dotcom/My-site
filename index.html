<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø·Ù‚Ø³ AI - Global Multi-Language</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #0e1621; --tg-sent: #2b5278; --accent: #64b5f6; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; height: 100vh; display: flex; flex-direction: column; }
        .header { background: #242f3d; padding: 15px; display: flex; align-items: center; gap: 15px; border-bottom: 2px solid var(--tg-sent); }
        .chat-area { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 12px; }
        .msg { max-width: 85%; padding: 15px; border-radius: 18px; line-height: 1.6; font-size: 15px; }
        .ai { background: var(--tg-sent); align-self: flex-start; border-bottom-right-radius: 4px; }
        .user { background: #182533; align-self: flex-end; border-bottom-left-radius: 4px; color: #a8b2bd; }
        .report-card { background: rgba(0,0,0,0.4); border-radius: 12px; padding: 15px; margin-top: 10px; border-left: 5px solid var(--accent); }
        .input-bar { background: #242f3d; padding: 15px; display: flex; gap: 10px; }
        input { flex: 1; background: #17212b; border: none; border-radius: 25px; padding: 12px 20px; color: white; outline: none; }
        button { background: var(--accent); border: none; color: white; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; }
    </style>
</head>
<body>

<div class="header">
    <div style="width:45px; height:45px; border-radius:50%; background:linear-gradient(45deg, #10a37f, #64b5f6); display:flex; align-items:center; justify-content:center; font-size:22px;">ğŸŒ</div>
    <div>
        <div style="font-weight: bold;" id="botTitle">Ø§Ù„Ø·Ù‚Ø³ AI - Multilingual</div>
        <div style="font-size: 11px; color: var(--accent);" id="botStatus">ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©ØŒ EnglishØŒ FranÃ§ais...</div>
    </div>
</div>

<div class="chat-area" id="chat">
    <div class="msg ai" id="welcomeMsg">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ø±ØµØ§Ø¯ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ. Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø£ÙŠ Ù…Ø¯ÙŠÙ†Ø© ÙˆØ³Ø£Ø±Ø¯ Ø¹Ù„ÙŠÙƒ Ø¨Ù†ÙØ³ Ù„ØºØªÙƒ.</div>
</div>

<div class="input-bar">
    <input type="text" id="cityInput" placeholder="Write a city... Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ù…Ø¯ÙŠÙ†Ø©..." onkeypress="if(event.key === 'Enter') analyze()">
    <button onclick="analyze()"><i class="fas fa-paper-plane"></i></button>
</div>

<script>
    async function analyze() {
        const input = document.getElementById('cityInput');
        let city = input.value.trim();
        if(!city) return;

        addMsg('user', city);
        input.value = '';

        // ÙƒØ´Ù Ø§Ù„Ù„ØºØ© (Ø¨Ø³ÙŠØ·: Ø¥Ø°Ø§ Ø§Ø­ØªÙˆÙ‰ Ø¹Ù„Ù‰ Ø­Ø±ÙˆÙ Ø¹Ø±Ø¨ÙŠØ©)
        const isArabic = /[\u0600-\u06FF]/.test(city);
        const lang = isArabic ? 'ar' : 'en';

        // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨Ø­Ø« (Ø¥Ø²Ø§Ù„Ø© ÙƒÙ„Ù…Ø© Ø§Ù„Ù…ØºØ±Ø¨ Ø¥Ø°Ø§ ÙƒØªØ¨Øª Ø·Ù†Ø¬Ø© Ø§Ù„Ù…ØºØ±Ø¨) Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ Ø§Ù„Ù€ API
        let cleanCity = city.replace(/Ø§Ù„Ù…ØºØ±Ø¨|Morocco|maroc/gi, '').trim();

        try {
            const geoRes = await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${encodeURIComponent(cleanCity)}&count=1&language=${lang}`);
            const geoData = await geoRes.json();
            
            if(!geoData.results) {
                addMsg('ai', isArabic ? 'âš ï¸ Ù„Ù… Ø£Ø¬Ø¯ Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©ØŒ Ø¬Ø±Ø¨ Ø§Ø³Ù…Ø§Ù‹ Ø£Ø¨Ø³Ø·.' : 'âš ï¸ City not found, try a simpler name.');
                return;
            }

            const {latitude, longitude, name, country} = geoData.results[0];
            const wRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${latitude}&longitude=${longitude}&current_weather=true&hourly=precipitation_probability,relativehumidity_2m&timezone=auto`);
            const w = await wRes.json();

            const temp = w.current_weather.temperature;
            const wind = w.current_weather.windspeed;
            const rain = w.hourly.precipitation_probability[0];

            let report = isArabic ? `<b>ØªØ­Ù„ÙŠÙ„ ${name} (${country}):</b><br>` : `<b>Analysis for ${name} (${country}):</b><br>`;
            report += `<div class="report-card">`;
            report += isArabic ? `ğŸŒ¡ï¸ Ø§Ù„Ø­Ø±Ø§Ø±Ø©: ${temp}Â°C<br>` : `ğŸŒ¡ï¸ Temp: ${temp}Â°C<br>`;
            report += isArabic ? `ğŸ’¨ Ø§Ù„Ø±ÙŠØ§Ø­: ${wind} ÙƒÙ…/Ø³<br>` : `ğŸ’¨ Wind: ${wind} km/h<br>`;
            report += isArabic ? `â˜” Ø§Ù„Ù…Ø·Ø±: ${rain}%` : `â˜” Rain: ${rain}%`;
            report += `</div>`;

            if(rain > 70) report += `<div style="color:#ff5252; margin-top:10px; font-weight:bold;">${isArabic ? 'âš ï¸ Ø®Ø·Ø± ÙÙŠØ¶Ø§Ù†Ø§Øª!' : 'âš ï¸ Flood Risk!'}</div>`;

            addMsg('ai', report);
        } catch(e) {
            addMsg('ai', 'Error âŒ');
        }
    }

    function addMsg(t, s) {
        const c = document.getElementById('chat');
        const d = document.createElement('div');
        d.className = `msg ${t}`; d.innerHTML = s;
        c.appendChild(d); c.scrollTop = c.scrollHeight;
    }
</script>
</body>
</html>

